<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <link rel="canonical" href="https://code-logs.github.io/heroku로-node.js-애플리케이션-배포하기" />
    <link rel="apple-touch-icon" href="/icons/icon-192x-192.png" />
    <link rel="manifest" href="/manifest.json" />
    <meta name="theme-color" content="#fff" />
    <meta property="og:type" content="website" />
    <meta property="og:site_name" content="Code Logs" />
    <meta name="author" content="Jay Lee" />
    <meta name="viewport" content="width=device-width, user-scalable=no" />
    <meta
      name="keyword"
      content="cloud, cloud service, deploy, heroku, node.js, paas, 배포, Heroku로 Node.js 애플리케이션 배포하기, Heroku를 이용한 NodeJS  애플리케이션 배포하기, cloud"
    />
    <meta
      name="description"
      content="Code Logs Heroku로 Node.js 애플리케이션 배포하기 - Heroku를 이용한 NodeJS  애플리케이션 배포하기 | cloud, cloud, cloud service, deploy, heroku, node.js, paas, 배포"
    />
    <meta
      property="og:description"
      content="Code Logs Heroku로 Node.js 애플리케이션 배포하기 - Heroku를 이용한 NodeJS  애플리케이션 배포하기 | cloud, cloud, cloud service, deploy, heroku, node.js, paas, 배포"
    />
    <meta property="og:title" content="Heroku로 Node.js 애플리케이션 배포하기 | Code Logs" />
    <meta property="og:url" content="https://code-logs.github.io/heroku로-node.js-애플리케이션-배포하기" />
    <meta property="og:image" content="/assets/images/deploy-node-js-via-heroku.png" />
    <title>Heroku로 Node.js 애플리케이션 배포하기 | Code Logs</title>
    <meta name="next-head-count" content="16" />
    <link rel="preload" href="/_next/static/css/afc718406f0a3821.css" as="style" />
    <link rel="stylesheet" href="/_next/static/css/afc718406f0a3821.css" data-n-g="" />
    <link rel="preload" href="/_next/static/css/22e43734d62d85ee.css" as="style" />
    <link rel="stylesheet" href="/_next/static/css/22e43734d62d85ee.css" data-n-p="" />
    <noscript data-n-css=""></noscript>
    <script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script>
    <script src="/_next/static/chunks/webpack-2e51481b1d484a05.js" defer=""></script>
    <script src="/_next/static/chunks/framework-5f4595e5518b5600.js" defer=""></script>
    <script src="/_next/static/chunks/main-a4d9e436b9a532ca.js" defer=""></script>
    <script src="/_next/static/chunks/pages/_app-8b1c655d67dc7e3d.js" defer=""></script>
    <script src="/_next/static/chunks/294-cb5252cdae161d2e.js" defer=""></script>
    <script src="/_next/static/chunks/867-9ef2270e5f6721ff.js" defer=""></script>
    <script src="/_next/static/chunks/pages/%5Btitle%5D-2b2d71d8d2c33d0f.js" defer=""></script>
    <script src="/_next/static/MRFX5_sz-n4ah9q5Q1_HZ/_buildManifest.js" defer=""></script>
    <script src="/_next/static/MRFX5_sz-n4ah9q5Q1_HZ/_ssgManifest.js" defer=""></script>
    <script src="/_next/static/MRFX5_sz-n4ah9q5Q1_HZ/_middlewareManifest.js" defer=""></script>
  </head>
  <body>
    <div id="__next" data-reactroot="">
      <header class="Header_header__RW35m">
        <span class="Header_title__GPS8b">Code Logs</span>
        <ul class="Header_socialIcons__CBf_s">
          <li>
            <a href="https://github.com/possible819" target="_blank" rel="noreferrer" aria-label="My Github"
              ><style data-emotion="css vubbuv">
                .css-vubbuv {
                  -webkit-user-select: none;
                  -moz-user-select: none;
                  -ms-user-select: none;
                  user-select: none;
                  width: 1em;
                  height: 1em;
                  display: inline-block;
                  fill: currentColor;
                  -webkit-flex-shrink: 0;
                  -ms-flex-negative: 0;
                  flex-shrink: 0;
                  -webkit-transition: fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                  transition: fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                  font-size: 1.5rem;
                }</style
              ><svg
                class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                focusable="false"
                aria-hidden="true"
                viewBox="0 0 24 24"
                data-testid="GitHubIcon"
              >
                <path
                  d="M12 1.27a11 11 0 00-3.48 21.46c.55.09.73-.28.73-.55v-1.84c-3.03.64-3.67-1.46-3.67-1.46-.55-1.29-1.28-1.65-1.28-1.65-.92-.65.1-.65.1-.65 1.1 0 1.73 1.1 1.73 1.1.92 1.65 2.57 1.2 3.21.92a2 2 0 01.64-1.47c-2.47-.27-5.04-1.19-5.04-5.5 0-1.1.46-2.1 1.2-2.84a3.76 3.76 0 010-2.93s.91-.28 3.11 1.1c1.8-.49 3.7-.49 5.5 0 2.1-1.38 3.02-1.1 3.02-1.1a3.76 3.76 0 010 2.93c.83.74 1.2 1.74 1.2 2.94 0 4.21-2.57 5.13-5.04 5.4.45.37.82.92.82 2.02v3.03c0 .27.1.64.73.55A11 11 0 0012 1.27"
                ></path></svg
            ></a>
          </li>
        </ul>
        <nav class="NavBar_navBar__akqA3">
          <ul>
            <li class="clickable"><a href="/" class="MarkedAnchor_anchor__QCmkL">Home</a></li>
            <li class="clickable"><a href="/posts/1" class="MarkedAnchor_anchor__QCmkL">Posts</a></li>
            <li class="clickable"><a href="/about" class="MarkedAnchor_anchor__QCmkL">About</a></li>
          </ul>
        </nav>
      </header>
      <main>
        <article class="PostDetail_container__Ma_26">
          <p class="PostDetail_publishedAt__7GOQm"><span>22.03.04</span></p>
          <section class="PostDetail_thumbnailWrapper__oALCg">
            <img src="/assets/images/deploy-node-js-via-heroku.png" alt="Heroku를 이용한 NodeJS  애플리케이션 배포하기" width="400" height="300" />
          </section>
          <section>
            <h1>Heroku로 Node.js 애플리케이션 배포하기</h1>
            <p class="PostDetail_description__l6wHC">Heroku를 이용한 NodeJS 애플리케이션 배포하기</p>
          </section>
          <section>
            <h2 id="table-of-contents">Table of contents</h2>
            <ol>
              <li><a href="#what-is-heroku">What is Heroku?</a></li>
              <li><a href="#heroku-cli-%EC%84%A4%EC%B9%98%ED%95%98%EA%B8%B0">Heroku CLI 설치하기</a></li>
              <li><a href="#%EB%B0%B0%ED%8F%AC%EC%9D%98-%EC%8B%9C%EC%9E%91---heroku-create">배포의 시작 - Heroku create</a></li>
              <li>
                <a href="#%EB%B0%B0%ED%8F%AC%ED%95%98%EA%B8%B0---heroku-%EC%9B%90%EA%B2%A9-%EC%A0%80%EC%9E%A5%EC%86%8C%EC%97%90-push"
                  >배포하기 - Heroku 원격 저장소로 Push</a
                >
              </li>
              <li>
                <a href="#%EC%95%B1-%EC%8B%A4%ED%96%89%EC%9D%84-%EC%9C%84%ED%95%9C-%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8-%EC%A0%95%EC%9D%98---procfile"
                  >앱 실행을 위한 스크립트 정의 - Procfile</a
                >
              </li>
              <li><a href="#%EC%9E%90%EB%8F%99%EB%B0%B0%ED%8F%AC---github%EB%A1%9C-%EA%B0%84%EB%8B%A8%ED%95%98%EA%B2%8C">자동배포 - GitHub로 간단하게</a></li>
              <li>
                <a href="#scaling---scale-updown--scale-outin">Scaling - Scale up/down &amp; Scale out/in</a>
                <ol>
                  <li><a href="#scale-updown">Scale up/down</a></li>
                  <li><a href="#scale-outin">Scale out/in</a></li>
                </ol>
              </li>
              <li>
                <a href="#%EA%B7%B8-%EB%B0%96%EC%9D%98-%EB%82%B4%EC%9A%A9">그 밖의 내용</a>
                <ol>
                  <li><a href="#%EC%84%9C%EB%B9%84%EC%8A%A4-%EB%A1%9C%EA%B7%B8-%EB%B3%B4%EA%B8%B0---heroku-logs">서비스 로그 보기 - Heroku logs</a></li>
                  <li>
                    <a
                      href="#local-%ED%99%98%EA%B2%BD%EC%97%90%EC%84%9C-%EC%95%A0%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98-%EC%8B%A4%ED%96%89%ED%95%98%EA%B8%B0"
                      >Local 환경에서 애플리케이션 실행하기</a
                    >
                  </li>
                  <li><a href="#%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%A0%91%EC%86%8D%ED%95%98%EA%B8%B0---heroku-open">서비스 접속하기 - Heroku open</a></li>
                  <li>
                    <a href="#heroku-%EB%82%B4%EB%B6%80%EA%B0%80-%EA%B6%81%EA%B8%88-%ED%95%A0-%EB%95%8C---heroku-run-bash"
                      >Heroku 내부가 궁금 할 때 - Heroku run bash</a
                    >
                  </li>
                  <li><a href="#%EB%AA%85%EB%A0%B9%EC%96%B4%EC%99%80-%EB%A1%9C%EA%B7%B8-%EB%B3%B4%EA%B8%B0---debug">명령어와 로그 보기 - DEBUG=*</a></li>
                  <li>
                    <a href="project-%EC%BB%A4%EB%A7%A8%EB%93%9C-%EC%8B%A4%ED%96%89%ED%95%98%EA%B8%B0-heroku-run-cmd"
                      >Project 커맨드 실행하기 - Heroku run cmd</a
                    >
                  </li>
                  <li><a href="#heroku-%EB%AC%B4%EB%A3%8C%EC%9A%94%EA%B8%88-%EC%A0%95%EC%B1%85">Heroku 무료요금 정책</a></li>
                </ol>
              </li>
              <li><a href="#%EB%A7%88%EC%B9%98%EB%A9%B0">마치며</a></li>
            </ol>
            <h2 id="what-is-heroku">What is Heroku?</h2>
            <p><code>Heroku</code>는 2007년 6월 개발이 시작된 최초의 클라우드 플랫폼 중 하나다.</p>
            <p>
              <a href="https://en.wikipedia.org/wiki/Platform_as_a_service">PaaS</a> 형태의 클라우드 서비스로 처음에는 <code>Rails</code> 앱의 배포 및 관리를
              지원하는 플랫폼이였고 현재는 <code>Java</code>, <code>Node.js</code>, <code>Scala</code>, <code>Clojure</code>, <code>Python</code>,
              <code>PHP</code>, <code>Go</code>를 지원한다.
            </p>
            <p>
              <code>Heroku</code>는 <code>Heroku CLI</code>를 제공하며 이를 통해 애플리케이션의 배포 및 관리 등의 작업을 수행 할 수 있도록 돕고
              <code>GitHub</code>와의 연동을 통해 저장소의 변경사항을 감지하고 자동배포 하는 등의 기능을 제공한다.
            </p>
            <p>
              <code>Heroku</code>를 이용해 <code>Node.js</code> 애플리케이션을 배포하고 <code>GitHub</code>와의 연동 설정을 통해 최신화된 소스 코드를 자동으로
              배포 할 수 있는 환경구성 과정을 기록한다.
            </p>
            <h2 id="heroku-cli-설치하기">Heroku CLI 설치하기</h2>
            <p><code>Heroku CLI</code>는 애플리케이션 배포 및 로그 확인 등 전체적인 애플리케이션 관리를 위해 사용된다.</p>
            <p>
              다음 <a href="https://devcenter.heroku.com/articles/getting-started-with-nodejs#set-up">링크</a>를 통해 설치 패키지를 다운받고 OS 환경에 맞는
              설치를 진행한다.
            </p>
            <h2 id="배포의-시작---heroku-create">배포의 시작 - Heroku create</h2>
            <p>배포하려는 Node.js 프로젝트의 root 디렉토리로 이동한다. 해당 디렉토리는 GitHub에 업로드된 상태여야 한다. (.git 디렉토리가 있어야 한다.)</p>
            <p>프로젝트 root 디렉토리에서 아래의 커맨드를 통해 애플리케이션을 생성한다.</p>
            <pre><code class="language-bash">$ heroku create ${APPLICATION_NAME} --region ${REGION}
</code></pre>
            <p><code>APPLICATION_NAME</code>과 <code>REGION</code>은 필수값이 아니며 해당 옵션들이 없는 상태에서도 애플리케이션 생성을 진행 할 수 있다.</p>
            <blockquote>
              <p><strong>APPLICATION_NAME</strong></p>
              <p>
                <code>APPLICATION_NAME</code>을 설정하지 않으면 임의이 문자가 자동으로 생성된다. 원하는 이름이 있다면 입력하면 된다.
                <code>APPLICATION_NAME</code>은 이후 서비스에 접근하기 위한 URL을 구성하는데 사용되기 때문에 알파벳과 숫자 그리고 <code>-</code> 만 입력할 수
                있다.
              </p>
            </blockquote>
            <blockquote>
              <p><strong>Region</strong></p>
              <p>
                다른 클라우드 서비스와 마찬가지로 서버의 지리적 위치를 선택하는 옵션이다. 서비스가 주로 제공될 지역에서 부터 물리적으로 가까운 곳에 위치한
                데이터센터를 선택하는 것이 더 좋은 네트워크 성능을 제공 받는데 도움이 된다.
              </p>
              <p>
                <code>heroku regions</code> 커맨드를 통해 사용 가능한 region 리스트를 확인 할 수 있으며, <code>Heroku</code>는 외부에 공개 할 용도의
                <code>Common Spaces</code> 유형과 분리된 네트워크 환경을 갖는 <code>Private Spaces</code> 유형을 제공한다.
              </p>
            </blockquote>
            <h2 id="배포하기---heroku-원격-저장소로-push">배포하기 - Heroku 원격 저장소로 Push</h2>
            <p>애플리케이션 생성이 완료되면 새로운 <code>git remote</code> 저장소가 정의된 것을 확인 할 수 있다.</p>
            <pre><code class="language-bash">$ git remote -v
heroku    https://git.heroku.com/application-name.git (fetch)
heroku    https://git.heroku.com/application-name.git (push)
</code></pre>
            <p>아래의 커맨드를 통해 <code>heroku</code> 원격 저장소에 소스 코드를 push 한다.</p>
            <pre><code class="language-bash">$ git push heroku main
</code></pre>
            <blockquote>
              <p><strong>애플리케이션 디펜던시 설정</strong></p>
              <p>
                <code>heroku</code>는 <code>package.json</code> 파일의 존재를 확인하고 Node.js 프로젝트임을 감지한 뒤 <code>package-lock.json</code> 파일을 통해
                필요한 디펜던시를 확인하고 설치하게 된다. (yarn을 사용할 경우 yarn-lock.json 파일) 따라서 프로젝트의 디펜던시를 설치한 이후 생성되는
                <code>package-lock.json</code> 또는 <code>yarn-lock.json</code> 파일을 커밋하는 것이 좋다.
              </p>
            </blockquote>
            <p>push 커맨드를 실행하면 소스코드를 업로드 하고 빌드와 배포를 자동으로 진행하게 된다.</p>
            <p>배포된 애플리케이션은 적어도 한개 이상의 노드에서 실행돼야 한다. 아래의 커맨드를 통해 실행중인 노드의 정보를 확인 할 수 있다.</p>
            <pre><code class="language-bash">$ heroku ps:scale
</code></pre>
            <h2 id="앱-실행을-위한-스크립트-정의---procfile">앱 실행을 위한 스크립트 정의 - Procfile</h2>
            <p>
              <code>heroku</code>는 배포된 파일을 통해 해당 프로젝트가 어떤 언어의 프로젝트인지 판단한다. Node.js의 경우 <code>package.json</code> 파일로
              Node.js 프로젝트임을 확인하고 <code>scripts</code> 프로퍼티를 통해 애플리케이션을 실행하기 위해 필요한 작업들은 진행한다.
            </p>
            <p>
              변경사항을 <code>heroku</code>
              <a href="#%EB%B0%B0%ED%8F%AC%ED%95%98%EA%B8%B0---heroku-%EC%9B%90%EA%B2%A9-%EC%A0%80%EC%9E%A5%EC%86%8C%EB%A1%9C-push">원격 저장소에 push</a> 하면
              로그를 출력하는데 이 로그를 통해 <code>heroku</code>가 어떤 작업들을 수행하는지 확인 할 수 있다.
            </p>
            <p>
              간추려서 이야기 해보면 <code>node 설치</code> → <code>npm 또는 yarn 설치</code> → <code>dependency 설치</code> → <code>build script 실행</code> →
              <code>dev dependency 삭제</code> → <code>start script 실행</code>의 순서로 작업을 수행하게 된다.
            </p>
            <blockquote>
              <p><strong>Build script 실행</strong></p>
              <p>build script를 실행 할 때 heroku는 기본적으로 <code>build</code>라는 명칭의 스크립트를 찾고 있다면 이것을 실행한다.</p>
              <p><strong>Start script 실행</strong></p>
              <p>start script를 실행 할 때 heroku는 기본적으로 <code>start</code>라는 명칭의 스크립트를 찾고 있다면 이것을 실행한다.</p>
            </blockquote>
            <blockquote>
              <p><strong>devDependency prune</strong></p>
              <p>
                heroku는 배포 프로세스를 수행하고 가장 마지막 단계에서 devDependency를 삭제하는 절차를 포함하고 있다. (저장공간의 점유를 최소화 하기 위함이
                아닐까 생각이 든다.)
              </p>
              <p>
                사용자로서 주의할 점은 devDependency가 이미 삭제된 이후 devDependency에 의존적인 작업을 수행 할 경우가 있는데 (ex. data migration) 이 경우 해당
                작업을 정상적으로 수행할 수 없다.
              </p>
              <p>
                Heroku는 이런 추가적인 작업을 특정 시점에 수행 할 수 있도록 빌드 스탭에 따른 스크립트 정의를 지원한다. -
                <a href="https://devcenter.heroku.com/articles/nodejs-support#heroku-specific-build-steps">참조</a>
              </p>
            </blockquote>
            <p>
              <code>Procfile</code>은 애플리케이션 실행시 실행할 커맨드를 정의할 수 있는 파일이다. 프로젝트 root 디렉토리에 파일을 생성하고
              <code>&lt;process&gt;: &lt;command&gt;</code>의 형태로 내용을 추가하면 <code>Heroku</code>는 이 파일을 기준으로 커맨드를 실행하게 된다.
            </p>
            <pre><code>web: npm start
</code></pre>
            <p>그 밖의 다양한 커맨드를 설정 할 수 있으며 자세한 내용은 <a href="https://devcenter.heroku.com/articles/procfile">가이드</a>를 참조</p>
            <h2 id="자동배포---github로-간단하게">자동배포 - GitHub로 간단하게</h2>
            <p>GitHub 연동은 <a href="https://heroku.com/">heroku 사이트</a>에서 아주 간단히 설정 할 수 있다.</p>
            <p>애플리케이션이 정상적으로 생성 되었다면 heroku 사이트에 로그인한 뒤 생성한 애플리케이션 목록을 확인 할 수 있다.</p>
            <p>
              애플리케이션 목록을 클릭해 상세 설정으로 이동 → <code>Deploy</code> 메뉴로 이동한다. <code>Deploy method</code> 중 GitHub을 선택하고
              <code>인증</code> → <code>배포 대상 브랜치 선택</code>만 해주면 자동배포 설정이 완료된다.
            </p>
            <h2 id="scaling---scale-updown--scale-outin">Scaling - Scale up/down &amp; Scale out/in</h2>
            <p>아래의 커맨드를 통해 현재 배포된 애플리케이션이 몇개의 노드를 통해 서비스 되고 있는지 확인 할 수 있다.</p>
            <pre><code class="language-bash">$ heroku ps:scale
web=1:Free
</code></pre>
            <p><code>heroku ps:scale</code> 커맨드를 통해 확인한 web=1:Free는 <code>Dynos유형:Dynos수량:Dynos크기</code>의 조합이다.</p>
            <blockquote>
              <p><strong>Dynos</strong></p>
              <p><code>Dynos</code>는 일반적으로 node, instance 또는 container라고 부르는 실행환경을 의미한다</p>
            </blockquote>
            <h3 id="scale-updown">Scale up/down</h3>
            <p>Scale up/down은 Dynos 크기를 조절하여 더 높거나 낮은 성능의 node를 사용하도록 변경하면 된다.</p>
            <pre><code class="language-bash">$ heroku ps:scale web=1:hobby
</code></pre>
            <blockquote>
              <p>Free Dynos를 제외한 다른 유형의 Dynos는 결제 정보가 입력된 사용자에 한해 사용설정 할 수 있다.</p>
            </blockquote>
            <h3 id="scale-outin">Scale out/in</h3>
            <p>Scale out/in은 Dynos 수량을 조절하는 것을 통해 가능하다.</p>
            <pre><code class="language-bash">$ heroku ps:scale web=2
</code></pre>
            <p>
              <code>web</code> 유형의 dynos는 무료 서비스로 위 커맨드를 그대로 실행 할 경우 무료 서비스에 한해 <em>스케일 아웃 할 수 없다</em>는 에러 메시지가
              출력된다.
            </p>
            <blockquote>
              <p><strong>Dynos types</strong></p>
              <p>
                Dynos는 <code>Web</code>, <code>Worker</code>, <code>One-off</code> 세가지 유형이 존재한다. 배포하고자 하는 애플리케이션의 성격에 맞는 Dynos를
                선택해야한다. <code>Web</code>은 일반적인 Web application을, <code>Worker</code>는 Batch 성향의 백그라운드 프로세스를, <code>One-off</code>는
                idle 상태를 유지하다 필요한 순간에만 active 되는 서비스를 배포하기에 적절한 유형이다 -
                <a href="https://devcenter.heroku.com/articles/dynos#dyno-configurations">자세히 보기</a>
              </p>
              <p><strong>Dynos 크기</strong></p>
              <p>
                Dynos 크기는 쉽게 이야기해서 하드웨어 성능을 의미한다. Heroku가 제공하는 Dynos 크기의 종류 및 각 크기별 spec은
                <a href="https://devcenter.heroku.com/articles/dyno-types">링크</a>를 통해 확인 할 수 있다.
              </p>
            </blockquote>
            <h2 id="그-밖의-내용">그 밖의 내용</h2>
            <h3 id="서비스-로그-보기---heroku-logs">서비스 로그 보기 - Heroku logs</h3>
            <p>아래의 커맨드를 통해 실행중인 서비스가 출력하는 로그를 확인 할 수 있다.</p>
            <pre><code class="language-bash">$ heroku logs --tail
</code></pre>
            <h3 id="local-환경에서-애플리케이션-실행하기">Local 환경에서 애플리케이션 실행하기</h3>
            <p>다음 커맨드를 통해 local 환경에서 애플리케이션 실행을 할 수 있다.</p>
            <pre><code class="language-bash">$ heroku local web
</code></pre>
            <p>
              위 커맨드를 통해 local 환경에서 애플리케이션을 실행 할 경우 <code>heroku</code>는 <code>Procfile</code>을 참조하여 실행 할 스크립트를 판단한다.
            </p>
            <h3 id="서비스-접속하기---heroku-open">서비스 접속하기 - Heroku open</h3>
            <p>아래 커맨드를 입력하여 브라우저를 통해 서비스에 접근할 수 있다.</p>
            <pre><code class="language-bash">$ heroku open
</code></pre>
            <h3 id="heroku-내부가-궁금-할-때---heroku-run-bash">Heroku 내부가 궁금 할 때 - Heroku run bash</h3>
            <p>아래 커맨드를 통해 <code>heroku</code> 노드 내부를 탐색 할 수 있다.</p>
            <pre><code class="language-bash">$ heroku run bash
</code></pre>
            <h3 id="명령어와-로그-보기---debug">명령어와 로그 보기 - DEBUG=*</h3>
            <p>
              heroku 커맨드를 실행할 때 아래와 같이 <code>DEBUG=*</code> prefix를 주면 DEBUG 콘솔이 활성화 되어 문제가 발생 했을때 어떤 프로세스에서 문제가
              발생했는지 조금 더 상세히 파악 할 수 있다.
            </p>
            <pre><code class="language-bash">$ DEBUG=* heroku local web
</code></pre>
            <h3 id="project-커맨드-실행하기---heroku-run-cmd">Project 커맨드 실행하기 - Heroku run cmd</h3>
            <p><code>Heroku</code> 노드 내부에서 어떤 커맨드를 실행하고 싶다면 아래의 명령어를 사용한다.</p>
            <pre><code class="language-bash">$ heroku run echo HelloWorld
</code></pre>
            <h3 id="heroku-무료요금-정책">Heroku 무료요금 정책</h3>
            <p>작성일 기준 Web dyno는 기본적으로 무료지만 몇가지 제약 조건이 있다.</p>
            <p><strong>Sleep 상태로 전환</strong></p>
            <p>
              30분 동안 트래픽이 발생하지 않을 경우 IDLE 상태로 전환되고, 다시 트래픽이 발생하면 약간의 delay를 두고 활성화 됨 (노드가 잠시 IDLE 상태로 전환
              되었다가 다시 올라오는 것이 아닌 노드 자체가 Reset 되는 것 처럼 보인다. 예를들어 <code>sqlite</code> 데이터베이스를 파일형태로 가지고 있었다면
              데이터베이스 파일도 삭제된다.)
            </p>
            <p><strong>Dyno hour pool</strong></p>
            <p>
              사용자는 매달 web dyno를 운영 할 수 있는 시간의 제약이 있다. 기본적으로는 매달 550 시간이 주어지고 유효한 결재정보를 입력한 사용자의 경우
              추가적으로 450 시간의 무료 이용 시간을 제공 받을 수 있다. 아래 명령을 통해 잔여 시간을 확인 할 수 있다.
            </p>
            <pre><code class="language-bash">$ heroku ps -a ${APPLICATION_NAME}`
Free dyno hours quota remaining this month: 1000h 0m (100%)
Free dyno usage for this app: 0h 0m (0%)
</code></pre>
            <h2 id="마치며">마치며</h2>
            <p>
              블로그에서 사용할 <a href="https://github.com/code-logs/hit-counter">hit-counter</a>를 개발해서 배포하려다가 예전에 해봤던 heroku를 통해
              배포하기로 결정했고 그참에 다시금 heroku를 조금 더 상세히 확인하는 계기가 되었다.
              <del>데이터베이스가 휘발되는 바람에 기껏 만들고 사용은 안하게 됐다</del>
            </p>
            <p>이전에 사용경험이 그리 좋지 않았는데 아무래도 당시 내가 이해하기에는 조금 버거운 내용들이 있어서 그랬던게 아닐까 생각하게 된다.</p>
            <p>
              다시 사용해 본 heroku는 상당히 많은 부분이 자동화 되어 있고 정말 편하게 배포를 할 수 있다는 인상을 받았다 또 적재적소에 커스터마이징 할 수 있는
              요소들을 제공해서 배포 과정에 고민하게 되는 많은 문제점들을 해결 해 줄 수 있으리라는 생각도 들었다.
            </p>
            <p>배포에 필요한 꽤 많은 부분에 대해 정리했다고 생각이 드는데 heroku가 제공해주는 기능중 극히 일부분만 정리된 것이라는 것도 참 놀라운 일이다.</p>
          </section>
        </article>
        <section class="MainAdsBanner_container__YWe5C">
          <ins
            class="adsbygoogle"
            style="display: block"
            data-ad-client="ca-pub-7134579063537339"
            data-ad-slot="5391522351"
            data-ad-format="auto"
            data-full-width-responsive="true"
          ></ins>
        </section>
        <section class="PostDetail_references__EU_hH">
          <h2>참고</h2>
          <ul class="PostDetail_references__EU_hH">
            <li><a href="https%3A%2F%2Fdevcenter.heroku.com%2F" target="_blank" rel="noreferrer">Heroku Dev Center</a></li>
            <li><a href="https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FPlatform_as_a_service" target="_blank" rel="noreferrer">Wiki - PaaS</a></li>
          </ul>
        </section>
        <section class="PostDetail_utterances__jZeOm">
          <h2>댓글</h2>
          <div class="Utterrances_utteranceContainer__qopWy"></div>
        </section>
      </main>
      <aside></aside>
      <footer class="Footer_footer__GLL0J"><p>ⓒ 2021. Jay Lee all rights reserved.</p></footer>
    </div>
    <script id="__NEXT_DATA__" type="application/json">
      {
        "props": {
          "pageProps": {
            "post": {
              "title": "Heroku로 Node.js 애플리케이션 배포하기",
              "description": "Heroku를 이용한 NodeJS  애플리케이션 배포하기",
              "fileName": "deploy-nodejs-via-heroku.md",
              "category": "cloud",
              "published": true,
              "publishedAt": "2022-03-04",
              "thumbnailName": "deploy-node-js-via-heroku.png",
              "tags": ["cloud", "cloud service", "deploy", "heroku", "node.js", "paas", "배포"],
              "references": [
                { "title": "Heroku Dev Center", "url": "https://devcenter.heroku.com/" },
                { "title": "Wiki - PaaS", "url": "https://en.wikipedia.org/wiki/Platform_as_a_service" }
              ],
              "order": 13
            },
            "content": "\u003ch2 id=\"table-of-contents\"\u003eTable of contents\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\u003ca href=\"#what-is-heroku\"\u003eWhat is Heroku?\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#heroku-cli-%EC%84%A4%EC%B9%98%ED%95%98%EA%B8%B0\"\u003eHeroku CLI 설치하기\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#%EB%B0%B0%ED%8F%AC%EC%9D%98-%EC%8B%9C%EC%9E%91---heroku-create\"\u003e배포의 시작 - Heroku create\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#%EB%B0%B0%ED%8F%AC%ED%95%98%EA%B8%B0---heroku-%EC%9B%90%EA%B2%A9-%EC%A0%80%EC%9E%A5%EC%86%8C%EC%97%90-push\"\u003e배포하기 - Heroku 원격 저장소로 Push\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#%EC%95%B1-%EC%8B%A4%ED%96%89%EC%9D%84-%EC%9C%84%ED%95%9C-%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8-%EC%A0%95%EC%9D%98---procfile\"\u003e앱 실행을 위한 스크립트 정의 - Procfile\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#%EC%9E%90%EB%8F%99%EB%B0%B0%ED%8F%AC---github%EB%A1%9C-%EA%B0%84%EB%8B%A8%ED%95%98%EA%B2%8C\"\u003e자동배포 - GitHub로 간단하게\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#scaling---scale-updown--scale-outin\"\u003eScaling - Scale up/down \u0026amp; Scale out/in\u003c/a\u003e\u003col\u003e\n\u003cli\u003e\u003ca href=\"#scale-updown\"\u003eScale up/down\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#scale-outin\"\u003eScale out/in\u003c/a\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#%EA%B7%B8-%EB%B0%96%EC%9D%98-%EB%82%B4%EC%9A%A9\"\u003e그 밖의 내용\u003c/a\u003e\u003col\u003e\n\u003cli\u003e\u003ca href=\"#%EC%84%9C%EB%B9%84%EC%8A%A4-%EB%A1%9C%EA%B7%B8-%EB%B3%B4%EA%B8%B0---heroku-logs\"\u003e서비스 로그 보기 - Heroku logs\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#local-%ED%99%98%EA%B2%BD%EC%97%90%EC%84%9C-%EC%95%A0%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98-%EC%8B%A4%ED%96%89%ED%95%98%EA%B8%B0\"\u003eLocal 환경에서 애플리케이션 실행하기\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%A0%91%EC%86%8D%ED%95%98%EA%B8%B0---heroku-open\"\u003e서비스 접속하기 - Heroku open\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#heroku-%EB%82%B4%EB%B6%80%EA%B0%80-%EA%B6%81%EA%B8%88-%ED%95%A0-%EB%95%8C---heroku-run-bash\"\u003eHeroku 내부가 궁금 할 때 - Heroku run bash\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#%EB%AA%85%EB%A0%B9%EC%96%B4%EC%99%80-%EB%A1%9C%EA%B7%B8-%EB%B3%B4%EA%B8%B0---debug\"\u003e명령어와 로그 보기 - DEBUG=*\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"project-%EC%BB%A4%EB%A7%A8%EB%93%9C-%EC%8B%A4%ED%96%89%ED%95%98%EA%B8%B0-heroku-run-cmd\"\u003eProject 커맨드 실행하기 - Heroku run cmd\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#heroku-%EB%AC%B4%EB%A3%8C%EC%9A%94%EA%B8%88-%EC%A0%95%EC%B1%85\"\u003eHeroku 무료요금 정책\u003c/a\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\"\u003e마치며\u003c/a\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"what-is-heroku\"\u003eWhat is Heroku?\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003eHeroku\u003c/code\u003e는 2007년 6월 개발이 시작된 최초의 클라우드 플랫폼 중 하나다.\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://en.wikipedia.org/wiki/Platform_as_a_service\"\u003ePaaS\u003c/a\u003e 형태의 클라우드 서비스로 처음에는 \u003ccode\u003eRails\u003c/code\u003e 앱의 배포 및 관리를 지원하는 플랫폼이였고 현재는 \u003ccode\u003eJava\u003c/code\u003e, \u003ccode\u003eNode.js\u003c/code\u003e, \u003ccode\u003eScala\u003c/code\u003e, \u003ccode\u003eClojure\u003c/code\u003e, \u003ccode\u003ePython\u003c/code\u003e, \u003ccode\u003ePHP\u003c/code\u003e, \u003ccode\u003eGo\u003c/code\u003e를 지원한다.\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eHeroku\u003c/code\u003e는 \u003ccode\u003eHeroku CLI\u003c/code\u003e를 제공하며 이를 통해 애플리케이션의 배포 및 관리 등의 작업을 수행 할 수 있도록 돕고 \u003ccode\u003eGitHub\u003c/code\u003e와의 연동을 통해 저장소의 변경사항을 감지하고 자동배포 하는 등의 기능을 제공한다.\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eHeroku\u003c/code\u003e를 이용해 \u003ccode\u003eNode.js\u003c/code\u003e 애플리케이션을 배포하고 \u003ccode\u003eGitHub\u003c/code\u003e와의 연동 설정을 통해 최신화된 소스 코드를 자동으로 배포 할 수 있는 환경구성 과정을 기록한다.\u003c/p\u003e\n\u003ch2 id=\"heroku-cli-설치하기\"\u003eHeroku CLI 설치하기\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003eHeroku CLI\u003c/code\u003e는 애플리케이션 배포 및 로그 확인 등 전체적인 애플리케이션 관리를 위해 사용된다.\u003c/p\u003e\n\u003cp\u003e다음 \u003ca href=\"https://devcenter.heroku.com/articles/getting-started-with-nodejs#set-up\"\u003e링크\u003c/a\u003e를 통해 설치 패키지를 다운받고 OS 환경에 맞는 설치를 진행한다.\u003c/p\u003e\n\u003ch2 id=\"배포의-시작---heroku-create\"\u003e배포의 시작 - Heroku create\u003c/h2\u003e\n\u003cp\u003e배포하려는 Node.js 프로젝트의 root 디렉토리로 이동한다. 해당 디렉토리는 GitHub에 업로드된 상태여야 한다. (.git 디렉토리가 있어야 한다.)\u003c/p\u003e\n\u003cp\u003e프로젝트 root 디렉토리에서 아래의 커맨드를 통해 애플리케이션을 생성한다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003e$ heroku create ${APPLICATION_NAME} --region ${REGION}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003eAPPLICATION_NAME\u003c/code\u003e과 \u003ccode\u003eREGION\u003c/code\u003e은 필수값이 아니며 해당 옵션들이 없는 상태에서도 애플리케이션 생성을 진행 할 수 있다.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003eAPPLICATION_NAME\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eAPPLICATION_NAME\u003c/code\u003e을 설정하지 않으면 임의이 문자가 자동으로 생성된다. 원하는 이름이 있다면 입력하면 된다.\n\u003ccode\u003eAPPLICATION_NAME\u003c/code\u003e은 이후 서비스에 접근하기 위한 URL을 구성하는데 사용되기 때문에 알파벳과 숫자 그리고 \u003ccode\u003e-\u003c/code\u003e 만 입력할 수 있다.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003eRegion\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e다른 클라우드 서비스와 마찬가지로 서버의 지리적 위치를 선택하는 옵션이다. 서비스가 주로 제공될 지역에서 부터 물리적으로 가까운 곳에 위치한 데이터센터를 선택하는 것이 더 좋은 네트워크 성능을 제공 받는데 도움이 된다.\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eheroku regions\u003c/code\u003e 커맨드를 통해 사용 가능한 region 리스트를 확인 할 수 있으며, \u003ccode\u003eHeroku\u003c/code\u003e는 외부에 공개 할 용도의 \u003ccode\u003eCommon Spaces\u003c/code\u003e 유형과 분리된 네트워크 환경을 갖는 \u003ccode\u003ePrivate Spaces\u003c/code\u003e 유형을 제공한다.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch2 id=\"배포하기---heroku-원격-저장소로-push\"\u003e배포하기 - Heroku 원격 저장소로 Push\u003c/h2\u003e\n\u003cp\u003e애플리케이션 생성이 완료되면 새로운 \u003ccode\u003egit remote\u003c/code\u003e 저장소가 정의된 것을 확인 할 수 있다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003e$ git remote -v\nheroku    https://git.heroku.com/application-name.git (fetch)\nheroku    https://git.heroku.com/application-name.git (push)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e아래의 커맨드를 통해 \u003ccode\u003eheroku\u003c/code\u003e 원격 저장소에 소스 코드를 push 한다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003e$ git push heroku main\n\u003c/code\u003e\u003c/pre\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003e애플리케이션 디펜던시 설정\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eheroku\u003c/code\u003e는 \u003ccode\u003epackage.json\u003c/code\u003e 파일의 존재를 확인하고 Node.js 프로젝트임을 감지한 뒤 \u003ccode\u003epackage-lock.json\u003c/code\u003e 파일을 통해 필요한 디펜던시를 확인하고 설치하게 된다. (yarn을 사용할 경우 yarn-lock.json 파일) 따라서 프로젝트의 디펜던시를 설치한 이후 생성되는 \u003ccode\u003epackage-lock.json\u003c/code\u003e 또는 \u003ccode\u003eyarn-lock.json\u003c/code\u003e 파일을 커밋하는 것이 좋다.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003epush 커맨드를 실행하면 소스코드를 업로드 하고 빌드와 배포를 자동으로 진행하게 된다.\u003c/p\u003e\n\u003cp\u003e배포된 애플리케이션은 적어도 한개 이상의 노드에서 실행돼야 한다. 아래의 커맨드를 통해 실행중인 노드의 정보를 확인 할 수 있다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003e$ heroku ps:scale\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"앱-실행을-위한-스크립트-정의---procfile\"\u003e앱 실행을 위한 스크립트 정의 - Procfile\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003eheroku\u003c/code\u003e는 배포된 파일을 통해 해당 프로젝트가 어떤 언어의 프로젝트인지 판단한다. Node.js의 경우 \u003ccode\u003epackage.json\u003c/code\u003e 파일로 Node.js 프로젝트임을 확인하고 \u003ccode\u003escripts\u003c/code\u003e 프로퍼티를 통해 애플리케이션을 실행하기 위해 필요한 작업들은 진행한다.\u003c/p\u003e\n\u003cp\u003e변경사항을 \u003ccode\u003eheroku\u003c/code\u003e \u003ca href=\"#%EB%B0%B0%ED%8F%AC%ED%95%98%EA%B8%B0---heroku-%EC%9B%90%EA%B2%A9-%EC%A0%80%EC%9E%A5%EC%86%8C%EB%A1%9C-push\"\u003e원격 저장소에 push\u003c/a\u003e 하면 로그를 출력하는데 이 로그를 통해 \u003ccode\u003eheroku\u003c/code\u003e가 어떤 작업들을 수행하는지 확인 할 수 있다.\u003c/p\u003e\n\u003cp\u003e간추려서 이야기 해보면 \u003ccode\u003enode 설치\u003c/code\u003e → \u003ccode\u003enpm 또는 yarn 설치\u003c/code\u003e → \u003ccode\u003edependency 설치\u003c/code\u003e → \u003ccode\u003ebuild script 실행\u003c/code\u003e → \u003ccode\u003edev dependency 삭제\u003c/code\u003e → \u003ccode\u003estart script 실행\u003c/code\u003e의 순서로 작업을 수행하게 된다.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003eBuild script 실행\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003ebuild script를 실행 할 때 heroku는 기본적으로 \u003ccode\u003ebuild\u003c/code\u003e라는 명칭의 스크립트를 찾고 있다면 이것을 실행한다.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eStart script 실행\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003estart script를 실행 할 때 heroku는 기본적으로 \u003ccode\u003estart\u003c/code\u003e라는 명칭의 스크립트를 찾고 있다면 이것을 실행한다.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003edevDependency prune\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eheroku는 배포 프로세스를 수행하고 가장 마지막 단계에서 devDependency를 삭제하는 절차를 포함하고 있다. (저장공간의 점유를 최소화 하기 위함이 아닐까 생각이 든다.)\u003c/p\u003e\n\u003cp\u003e사용자로서 주의할 점은 devDependency가 이미 삭제된 이후 devDependency에 의존적인 작업을 수행 할 경우가 있는데 (ex. data migration) 이 경우 해당 작업을 정상적으로 수행할 수 없다.\u003c/p\u003e\n\u003cp\u003eHeroku는 이런 추가적인 작업을 특정 시점에 수행 할 수 있도록 빌드 스탭에 따른 스크립트 정의를 지원한다. - \u003ca href=\"https://devcenter.heroku.com/articles/nodejs-support#heroku-specific-build-steps\"\u003e참조\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003ccode\u003eProcfile\u003c/code\u003e은 애플리케이션 실행시 실행할 커맨드를 정의할 수 있는 파일이다. 프로젝트 root 디렉토리에 파일을 생성하고 \u003ccode\u003e\u0026lt;process\u0026gt;: \u0026lt;command\u0026gt;\u003c/code\u003e의 형태로 내용을 추가하면 \u003ccode\u003eHeroku\u003c/code\u003e는 이 파일을 기준으로 커맨드를 실행하게 된다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eweb: npm start\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e그 밖의 다양한 커맨드를 설정 할 수 있으며 자세한 내용은 \u003ca href=\"https://devcenter.heroku.com/articles/procfile\"\u003e가이드\u003c/a\u003e를 참조\u003c/p\u003e\n\u003ch2 id=\"자동배포---github로-간단하게\"\u003e자동배포 - GitHub로 간단하게\u003c/h2\u003e\n\u003cp\u003eGitHub 연동은 \u003ca href=\"https://heroku.com/\"\u003eheroku 사이트\u003c/a\u003e에서 아주 간단히 설정 할 수 있다.\u003c/p\u003e\n\u003cp\u003e애플리케이션이 정상적으로 생성 되었다면 heroku 사이트에 로그인한 뒤 생성한 애플리케이션 목록을 확인 할 수 있다.\u003c/p\u003e\n\u003cp\u003e애플리케이션 목록을 클릭해 상세 설정으로 이동 → \u003ccode\u003eDeploy\u003c/code\u003e 메뉴로 이동한다.\n\u003ccode\u003eDeploy method\u003c/code\u003e 중 GitHub을 선택하고 \u003ccode\u003e인증\u003c/code\u003e → \u003ccode\u003e배포 대상 브랜치 선택\u003c/code\u003e만 해주면 자동배포 설정이 완료된다.\u003c/p\u003e\n\u003ch2 id=\"scaling---scale-updown--scale-outin\"\u003eScaling - Scale up/down \u0026amp; Scale out/in\u003c/h2\u003e\n\u003cp\u003e아래의 커맨드를 통해 현재 배포된 애플리케이션이 몇개의 노드를 통해 서비스 되고 있는지 확인 할 수 있다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003e$ heroku ps:scale\nweb=1:Free\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003eheroku ps:scale\u003c/code\u003e 커맨드를 통해 확인한 web=1:Free는 \u003ccode\u003eDynos유형:Dynos수량:Dynos크기\u003c/code\u003e의 조합이다.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003eDynos\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eDynos\u003c/code\u003e는 일반적으로 node, instance 또는 container라고 부르는 실행환경을 의미한다\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"scale-updown\"\u003eScale up/down\u003c/h3\u003e\n\u003cp\u003eScale up/down은 Dynos 크기를 조절하여 더 높거나 낮은 성능의 node를 사용하도록 변경하면 된다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003e$ heroku ps:scale web=1:hobby\n\u003c/code\u003e\u003c/pre\u003e\n\u003cblockquote\u003e\n\u003cp\u003eFree Dynos를 제외한 다른 유형의 Dynos는 결제 정보가 입력된 사용자에 한해 사용설정 할 수 있다.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"scale-outin\"\u003eScale out/in\u003c/h3\u003e\n\u003cp\u003eScale out/in은 Dynos 수량을 조절하는 것을 통해 가능하다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003e$ heroku ps:scale web=2\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003eweb\u003c/code\u003e 유형의 dynos는 무료 서비스로 위 커맨드를 그대로 실행 할 경우 무료 서비스에 한해 \u003cem\u003e스케일 아웃 할 수 없다\u003c/em\u003e는 에러 메시지가 출력된다.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003eDynos types\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eDynos는 \u003ccode\u003eWeb\u003c/code\u003e, \u003ccode\u003eWorker\u003c/code\u003e, \u003ccode\u003eOne-off\u003c/code\u003e 세가지 유형이 존재한다.\n배포하고자 하는 애플리케이션의 성격에 맞는 Dynos를 선택해야한다.\n\u003ccode\u003eWeb\u003c/code\u003e은 일반적인 Web application을, \u003ccode\u003eWorker\u003c/code\u003e는 Batch 성향의 백그라운드 프로세스를, \u003ccode\u003eOne-off\u003c/code\u003e는 idle 상태를 유지하다 필요한 순간에만 active 되는 서비스를 배포하기에 적절한 유형이다 - \u003ca href=\"https://devcenter.heroku.com/articles/dynos#dyno-configurations\"\u003e자세히 보기\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eDynos 크기\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eDynos 크기는 쉽게 이야기해서 하드웨어 성능을 의미한다.\nHeroku가 제공하는 Dynos 크기의 종류 및 각 크기별 spec은 \u003ca href=\"https://devcenter.heroku.com/articles/dyno-types\"\u003e링크\u003c/a\u003e를 통해 확인 할 수 있다.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch2 id=\"그-밖의-내용\"\u003e그 밖의 내용\u003c/h2\u003e\n\u003ch3 id=\"서비스-로그-보기---heroku-logs\"\u003e서비스 로그 보기 - Heroku logs\u003c/h3\u003e\n\u003cp\u003e아래의 커맨드를 통해 실행중인 서비스가 출력하는 로그를 확인 할 수 있다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003e$ heroku logs --tail\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"local-환경에서-애플리케이션-실행하기\"\u003eLocal 환경에서 애플리케이션 실행하기\u003c/h3\u003e\n\u003cp\u003e다음 커맨드를 통해 local 환경에서 애플리케이션 실행을 할 수 있다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003e$ heroku local web\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e위 커맨드를 통해 local 환경에서 애플리케이션을 실행 할 경우 \u003ccode\u003eheroku\u003c/code\u003e는 \u003ccode\u003eProcfile\u003c/code\u003e을 참조하여 실행 할 스크립트를 판단한다.\u003c/p\u003e\n\u003ch3 id=\"서비스-접속하기---heroku-open\"\u003e서비스 접속하기 - Heroku open\u003c/h3\u003e\n\u003cp\u003e아래 커맨드를 입력하여 브라우저를 통해 서비스에 접근할 수 있다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003e$ heroku open\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"heroku-내부가-궁금-할-때---heroku-run-bash\"\u003eHeroku 내부가 궁금 할 때 - Heroku run bash\u003c/h3\u003e\n\u003cp\u003e아래 커맨드를 통해 \u003ccode\u003eheroku\u003c/code\u003e 노드 내부를 탐색 할 수 있다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003e$ heroku run bash\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"명령어와-로그-보기---debug\"\u003e명령어와 로그 보기 - DEBUG=*\u003c/h3\u003e\n\u003cp\u003eheroku 커맨드를 실행할 때 아래와 같이 \u003ccode\u003eDEBUG=*\u003c/code\u003e prefix를 주면 DEBUG 콘솔이 활성화 되어 문제가 발생 했을때 어떤 프로세스에서 문제가 발생했는지 조금 더 상세히 파악 할 수 있다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003e$ DEBUG=* heroku local web\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"project-커맨드-실행하기---heroku-run-cmd\"\u003eProject 커맨드 실행하기 - Heroku run cmd\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003eHeroku\u003c/code\u003e 노드 내부에서 어떤 커맨드를 실행하고 싶다면 아래의 명령어를 사용한다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003e$ heroku run echo HelloWorld\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"heroku-무료요금-정책\"\u003eHeroku 무료요금 정책\u003c/h3\u003e\n\u003cp\u003e작성일 기준 Web dyno는 기본적으로 무료지만 몇가지 제약 조건이 있다.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eSleep 상태로 전환\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e30분 동안 트래픽이 발생하지 않을 경우 IDLE 상태로 전환되고, 다시 트래픽이 발생하면 약간의 delay를 두고 활성화 됨 (노드가 잠시 IDLE 상태로 전환 되었다가 다시 올라오는 것이 아닌 노드 자체가 Reset 되는 것 처럼 보인다. 예를들어 \u003ccode\u003esqlite\u003c/code\u003e 데이터베이스를 파일형태로 가지고 있었다면 데이터베이스 파일도 삭제된다.)\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eDyno hour pool\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e사용자는 매달 web dyno를 운영 할 수 있는 시간의 제약이 있다. 기본적으로는 매달 550 시간이 주어지고 유효한 결재정보를 입력한 사용자의 경우 추가적으로 450 시간의 무료 이용 시간을 제공 받을 수 있다. 아래 명령을 통해 잔여 시간을 확인 할 수 있다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003e$ heroku ps -a ${APPLICATION_NAME}`\nFree dyno hours quota remaining this month: 1000h 0m (100%)\nFree dyno usage for this app: 0h 0m (0%)\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"마치며\"\u003e마치며\u003c/h2\u003e\n\u003cp\u003e블로그에서 사용할 \u003ca href=\"https://github.com/code-logs/hit-counter\"\u003ehit-counter\u003c/a\u003e를 개발해서 배포하려다가 예전에 해봤던 heroku를 통해 배포하기로 결정했고 그참에 다시금 heroku를 조금 더 상세히 확인하는 계기가 되었다. \u003cdel\u003e데이터베이스가 휘발되는 바람에 기껏 만들고 사용은 안하게 됐다\u003c/del\u003e\u003c/p\u003e\n\u003cp\u003e이전에 사용경험이 그리 좋지 않았는데 아무래도 당시 내가 이해하기에는 조금 버거운 내용들이 있어서 그랬던게 아닐까 생각하게 된다.\u003c/p\u003e\n\u003cp\u003e다시 사용해 본 heroku는 상당히 많은 부분이 자동화 되어 있고 정말 편하게 배포를 할 수 있다는 인상을 받았다 또 적재적소에 커스터마이징 할 수 있는 요소들을 제공해서 배포 과정에 고민하게 되는 많은 문제점들을 해결 해 줄 수 있으리라는 생각도 들었다.\u003c/p\u003e\n\u003cp\u003e배포에 필요한 꽤 많은 부분에 대해 정리했다고 생각이 드는데 heroku가 제공해주는 기능중 극히 일부분만 정리된 것이라는 것도 참 놀라운 일이다.\u003c/p\u003e\n",
            "postsByCategory": []
          },
          "__N_SSG": true
        },
        "page": "/[title]",
        "query": { "title": "heroku로-node.js-애플리케이션-배포하기" },
        "buildId": "MRFX5_sz-n4ah9q5Q1_HZ",
        "isFallback": false,
        "gsp": true,
        "scriptLoader": []
      }
    </script>
  </body>
</html>
